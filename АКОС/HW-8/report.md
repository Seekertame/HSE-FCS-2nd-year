# Отчёт по ДЗ-8
## Вариант корректного завершения

Для корректного завершения работы клиента и сервера использованы сигналы `SIGINT`/`SIGTERM` и флаг в разделяемой памяти.

1. И в клиенте, и в сервере установлены обработчики сигналов `SIGINT` и `SIGTERM` с помощью `sigaction`.
2. При получении сигнала обработчик:
   - устанавливает локальный флаг остановки;
   - записывает в разделяемую память флаг `terminate = 1`;
   - делает `sem_post` на семафоры, чтобы разбудить процесс, который может быть заблокирован в `sem_wait`.
3. Основной цикл и клиента, и сервера периодически проверяет флаг `terminate` и локальный флаг остановки. При их установке цикл завершается.
4. Оба процесса выполняют `munmap` и `close` для разделяемой памяти.
5. Процесс, который первым создал сегмент (успешный `shm_open` с `O_CREAT | O_EXCL`), дополнительно:
   - уничтожает семафоры (`sem_destroy`);
   - удаляет объект разделяемой памяти через `shm_unlink`.

Таким образом, при попытке завершить любой один процесс по `Ctrl+C` флаг завершения попадает в разделяемую память, оба процесса корректно завершаются, а сегмент разделяемой памяти удаляется.

## Команды для сборки и запуска

Сборка из каталога `AKOS_HW-8`:

```bash
cmake -S . -B build
cmake --build build
````

Запуск в двух разных терминалах:

**Терминал 1 (сервер):**

```bash
cd build
./server
```

**Терминал 2 (клиент):**

```bash
cd build
./client
```

Остановка работы (корректное завершение обоих процессов и удаление сегмента разделяемой памяти) осуществляется по `Ctrl+C` в любом из процессов.
